# =============================================================================
# AI-Box Falco Deployment Configuration
# Generated by aibox -- DO NOT EDIT MANUALLY
#
# Configures Falco to use the eBPF driver for runtime security monitoring
# on developer workstations. Tuned for low CPU overhead (<2% average).
# =============================================================================

# --- Driver ---
# Use eBPF driver (not kernel module) for easier deployment on dev workstations.
# The modern_ebpf driver uses CO-RE (Compile Once - Run Everywhere) and does
# not require kernel headers.
engine:
  kind: modern_ebpf

# --- Rules ---
# Load AI-Box-specific rules alongside Falco defaults.
rules_files:
  - /etc/falco/falco_rules.yaml
  - /etc/aibox/falco_rules.yaml

# --- Output ---
# Write alerts to a JSON file that Vector collects.
file_output:
  enabled: true
  keep_alive: true
  filename: /var/log/aibox/falco-alerts.jsonl

# Log to stdout as well for debugging.
stdout_output:
  enabled: false

# gRPC output for programmatic access.
grpc:
  enabled: false

# --- Syslog ---
syslog_output:
  enabled: false

# --- Performance ---
# Buffer sizes tuned for developer workstation overhead budget (<2% CPU).
syscall_buf_size_preset: 4
outputs:
  rate: 100
  max_burst: 200

# --- Filtering ---
# Only monitor AI-Box containers (identified by label).
# This avoids monitoring unrelated workloads on the dev machine.
container_engines:
  docker:
    enabled: false
  podman:
    enabled: true
  cri:
    enabled: false
  lxc:
    enabled: false
  libvirt_lxc:
    enabled: false

# --- Logging ---
log_stderr: true
log_syslog: false
log_level: warning

# --- Metrics ---
metrics:
  enabled: true
  interval: 60s
  output_rule: true

# --- Watch config ---
watch_config_files: true
